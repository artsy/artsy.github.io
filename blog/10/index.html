
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Artsy Engineering</title>
  <meta name="author" content="">

  
  <meta name="description" content="
  
  
    
      
        



  
    
      
        
          
        
        
          Splitting up a large test suite
        
          
 ...">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:image" content="http://artsy.github.io/images/artsy_oss_image.png" />
  <meta property="og:image:type" content="image/png" />

  
  <link rel="canonical" href="http://artsy.github.io/blog/10/">
  <link rel="alternate" type="application/rss+xml" title="Artsy Engineering Blog" href="/feed">

  <link href="/favicon.png" rel="icon">
  <link href="/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css">

  <script src="/javascripts/jquery-1.11.3.min.js"> </script>
  <script src="/javascripts/gradient-fade.js"></script>
  <script src="/javascripts/noframework.waypoints.min.js"></script>
  <script src="/javascripts/sticky.min.js"></script>
  <script src="/javascripts/search.min.js"></script>

  

  <script type="text/javascript" src="https://fast.fonts.net/jsapi/f7f47a40-b25b-44ee-9f9c-cfdfc8bb2741.js"></script>


  <link href="" rel="alternate" title="Artsy Engineering" type="application/atom+xml">
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-12450662-3']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <!--[if IE 8]><link href="/stylesheets/custom/ie_font.css" type="text/css"><![endif]-->

</head>


<body>
  <div id="logo-container">
    <a id="lrg-mark" href="https://www.artsy.net/">
      <svg viewBox="0 0 510 510" width="40" height="40" xmlns="http://www.w3.org/2000/svg">
        <path transform="scale(1, -1) translate(0, -480)" d="M0 -32h512v512h-512v-512v0zM464 16h-80v80h-48v-80h-288v416h416v-416v0zM194 384h-40l-74 -186h38l20 52h72l19 -52h39l-74 186v0zM149 282l25 66l24 -66h-49v0z"/>
      </svg>
    </a>
  </div>
  <header id="banner"><div id="header">
  <div class="header-navigation">
    <ul>
      <li><a href="https://developers.artsy.net/">API</a></li>
      <li><a href="https://www.artsy.net/jobs">Careers</a></li>
      <li><a href="http://twitter.com/artsyopensource">@artsyopensource</a></li>
      <li><a href="http://www.artsy.net/">Artsy.net</a></li>
    </ul>
    <span class="header-section-title">
      
        <a href="/open-source">Open Source</a>
      
    </span>
  </div>

  <div class="header-sticky-container">
    <div class="header-logo">
      <h2><a href="http://artsy.github.io">Artsy</a></h2>
    </div>
    <div class="header-search">
      
        <h2><a href="/">Engineering Blog</a></h2>
        <span>
  <form action="/search" method="get">
    <input class="search" id="search-query" type="text" name="q" results="0" placeholder="Search"/>
  </form>

</span>
      
    </div>
  </div>
</div>
</header>
  <div class="header-hamburger">
    <button class="cmn-toggle-switch cmn-toggle-switch__htx">
      <span>toggle menu</span>
    </button>
  </div>
  <div id="main">
    <div id="content">

      <div class="blog-index">
  
  
    
      <article>
        
<div class="article-container">


  
    <div class="meta-container">
      <header>
        
          <a href="/blog/2015/09/24/splitting-up-a-large-test-suite/">
        
        
          <h2 class="entry-title">Splitting up a large test suite</h2>
        
          <p class="meta-author">
  



  

  
    <div class="meta">
      <span class="byline author vcard"><a href ="/author/joey">Joey Aghion<a/></span>
      
      <p class="fn">
        <a href="https://twitter.com/joeyAghion">@joeyAghion</a>
      </p>
      

    </div>
  

</p>
          </a>
      </header>
    </div>
  

  <div class="content-container">
    
    
        <p>A while back, we wrote about <a href="/blog/2012/10/09/how-to-run-rspec-test-suites-in-parallel-with-jenkins-ci-build-flow/">How to Run RSpec Test Suites in Parallel with Jenkins CI Build Flow</a>. A version of that still handles our largest test suite, but over time the initial division of specs became unbalanced. We ended up with some tasks that took twice as long as others. Even worse, in an attempt to rebalance task times, we ended up with awkward file patterns like <code>'spec/api/**/[a-m]*_spec.rb'</code>.</p>

<p>To keep our parallel spec tasks approximately equal in size and to support arbitrary concurrency, we've added a new <code>spec:sliced</code> task:</p>


        <p><a href="/blog/2015/09/24/splitting-up-a-large-test-suite/">Read on →</a></p>
    

    

    
  </div>


  <footer>
  </footer>

</div>

      </article>
  
    
      <article>
        
<div class="article-container">


  
    <div class="meta-container">
      <header>
        
          <a href="/blog/2015/09/24/mvvm-in-swift/">
        
        
          <h2 class="entry-title">MVVM in Swift</h2>
        
          <p class="meta-author">
  



  

  
    <div class="meta">
      <span class="byline author vcard"><a href ="/author/ash">Ash Furrow<a/></span>
      
      <p class="fn">
        <a href="https://twitter.com/ashfurrow">@ashfurrow</a>
      </p>
      

    </div>
  

</p>
          </a>
      </header>
    </div>
  

  <div class="content-container">
    
    
        <p>Model View ViewModel has become the default way I write apps on iOS – it makes writing iOS apps a joy. I've written <a href="https://www.objc.io/issues/13-architecture/mvvm/">about it</a> <a href="http://www.teehanlax.com/blog/model-view-viewmodel-for-ios/">again</a> and <a href="https://speakerdeck.com/ashfurrow/reactivecocoa-at-mdevcon-2014">again</a> and <a href="https://leanpub.com/iosfrp">oh my</a>.</p>

<p>But last Autumn, as our team was all-hands-on-deck to wrap up the <a href="http://artsy.github.io/blog/2014/11/13/eidolon-retrospective/">auctions kiosk app</a>, we chose not to use MVVM. Why not?</p>

<p>We were building a <em>new app</em> in a <em>new language</em> using a <em>non-Swift framework</em> for functional reactive programming. I was also teaching colleagues what they needed to know about ReactiveCocoa to help write the app. We used the MVC pattern because the relative cost of MVVM was too high.</p>

<p>"... <em>was</em> ..."</p>


        <p><a href="/blog/2015/09/24/mvvm-in-swift/">Read on →</a></p>
    

    

    
  </div>


  <footer>
  </footer>

</div>

      </article>
  
    
      <article>
        
<div class="article-container">


  
    <div class="meta-container">
      <header>
        
          <a href="/blog/2015/09/18/Cocoa-Architecture-Dependencies/">
        
        
          <h2 class="entry-title">Cocoa Architecture: Dependencies</h2>
        
          <p class="meta-author">
  



  

  
    <div class="meta">
      <span class="byline author vcard"><a href ="/author/orta">Orta Therox<a/></span>
      
      <p class="fn">
        <a href="https://twitter.com/orta">@orta</a>
      </p>
      

    </div>
  

</p>
          </a>
      </header>
    </div>
  

  <div class="content-container">
    
    
        <p>As a part of going through the design patterns we've found in the creation of the Artsy iOS apps, I'd like to talk a bit about some of
the way in which we decide our apps dependencies.</p>

<p>It's easy to think of your dependencies as being things in your Podfile, but it's a bit more nuanced than that. The tools you use for development, deployment, testing and external integrations are all things in which you depend on others to make your app work. I'd like to look into the hows and the whys of the decisions we've made.</p>


        <p><a href="/blog/2015/09/18/Cocoa-Architecture-Dependencies/">Read on →</a></p>
    

    

    
  </div>


  <footer>
  </footer>

</div>

      </article>
  
    
      <article>
        
<div class="article-container">


  
    <div class="meta-container">
      <header>
        
          <a href="/blog/2015/09/01/releasecop-tracks-stale-releases/">
        
        
          <h2 class="entry-title">Releasecop Tracks Stale Releases</h2>
        
          <p class="meta-author">
  



  

  
    <div class="meta">
      <span class="byline author vcard"><a href ="/author/joey">Joey Aghion<a/></span>
      
      <p class="fn">
        <a href="https://twitter.com/joeyAghion">@joeyAghion</a>
      </p>
      

    </div>
  

</p>
          </a>
      </header>
    </div>
  

  <div class="content-container">
    
    
        <p>Artsy practices a sort of <a href="http://en.wikipedia.org/wiki/Continuous_delivery">continuous delivery</a>. We keep release cycles short and the process of reviewing, testing, and deploying our software as reliable, fast, and automated as possible. (This blog has touched on these practices <a href="http://artsy.github.io/blog/categories/testing/">multiple</a> <a href="http://artsy.github.io/blog/categories/continuous-integration">times</a>.)</p>

<p>Usually, commits that have been reviewed and merged are immediately built and tested. Successfully built versions of the codebase are often automatically deployed to a staging environment. On an automated or frequent-but-manual basis, that version is deployed to a production environment. Thus, commits form a pipeline:</p>

<ul>
<li>From developers' working branches</li>
<li>To the master branch</li>
<li>Through a hopefully-successful build</li>
<li>To a staging environment</li>
<li>To production</li>
</ul>


<p>The number of apps and services we deploy has grown to <em>dozens</em> per team, so sometimes things fall through the cracks. We've been using <a href="https://github.com/joeyAghion/releasecop">Releasecop</a> for the last few months to get gentle email reminders when an environment could use a deploy.</p>


        <p><a href="/blog/2015/09/01/releasecop-tracks-stale-releases/">Read on →</a></p>
    

    

    
  </div>


  <footer>
  </footer>

</div>

      </article>
  
    
      <article>
        
<div class="article-container">


  
    <div class="meta-container">
      <header>
        
          <a href="/blog/2015/09/01/Cocoa-Architecture-Dropped-Design-Patterns/">
        
        
          <h2 class="entry-title">Cocoa Architecture: Dropped Design Patterns</h2>
        
          <p class="meta-author">
  



  

  
    <div class="meta">
      <span class="byline author vcard"><a href ="/author/orta">Orta Therox<a/></span>
      
      <p class="fn">
        <a href="https://twitter.com/orta">@orta</a>
      </p>
      

    </div>
  

</p>
          </a>
      </header>
    </div>
  

  <div class="content-container">
    
    
        <p>As a part of going through the design patterns we've found in the creation of the Artsy iOS apps, I'd like to talk a bit about some of the patterns that we've had and migrated away from. This is not 100% comprehensive, as there has been a lot of time, and a lot of people involved. Instead I'm going to try and give a birds eye view, and zoom in on some things that feel more important overall.</p>

<p>It's important to preface that I don't believe in perfect code, or am I a fan of big re-writes. We can spot a bad pattern, but not do anything about it. We do have apps to ship, not a codebase to make perfect for the sake of technical purity.</p>


        <p><a href="/blog/2015/09/01/Cocoa-Architecture-Dropped-Design-Patterns/">Read on →</a></p>
    

    

    
  </div>


  <footer>
  </footer>

</div>

      </article>
  
    
      <article>
        
<div class="article-container">


  
    <div class="meta-container">
      <header>
        
          <a href="/blog/2015/08/27/swift-trek-2-the-wrath-of-count/">
        
        
          <h2 class="entry-title">Swift Trek 2: The Wrath of count()</h2>
        
          <p class="meta-author">
  



  

  
    <div class="meta">
      <span class="byline author vcard"><a href ="/author/ash">Ash Furrow<a/></span>
      
      <p class="fn">
        <a href="https://twitter.com/ashfurrow">@ashfurrow</a>
      </p>
      

    </div>
  

</p>
          </a>
      </header>
    </div>
  

  <div class="content-container">
    
    
        <p>On Tuesday at our mobile practice standup, I mentioned that I was in-between projects and looking for something to do. Orta suggested migrating Eidolon, the Artsy bidding kiosk app, to Swift 2.</p>

<p>Our CI is <a href="https://github.com/artsy/eidolon/pull/466">broken anyway</a>, so now is the perfect opportunity to make changes that would break CI. Additionally, Swift 2 seems to have more-or-less stabilized in the latest betas, so we don't expect many gotchas leading up to the GM. Finally, this is an enterprise-distributed app, so we don't have to worry about submitting to the App Store using betas of Xcode.</p>

<p>So Swift 2 it is!</p>


        <p><a href="/blog/2015/08/27/swift-trek-2-the-wrath-of-count/">Read on →</a></p>
    

    

    
  </div>


  <footer>
  </footer>

</div>

      </article>
  
    
      <article>
        
<div class="article-container">


  
    <div class="meta-container">
      <header>
        
          <a href="/blog/2015/08/24/Cocoa-Architecture-Hybrid-Apps/">
        
        
          <h2 class="entry-title">Cocoa Architecture: Hybrid Apps</h2>
        
          <p class="meta-author">
  



  

  
    <div class="meta">
      <span class="byline author vcard"><a href ="/author/orta">Orta Therox<a/></span>
      
      <p class="fn">
        <a href="https://twitter.com/orta">@orta</a>
      </p>
      

    </div>
  

</p>
          </a>
      </header>
    </div>
  

  <div class="content-container">
    
    
        <p>As a part of going through the design patterns we've found in the creation of the Artsy iOS apps, I'd like to talk a bit about <em>Hybrid Applications</em>. A hybrid application refers to an app that uses native code and web content intertwined. Our flagship iOS app, <a href="https://github.com/artsy/eigen">eigen</a> is a hybrid app, and it seems to get more and more hybrid-y each release. Let's talk a little bit about the pros and cons of this approach.</p>


        <p><a href="/blog/2015/08/24/Cocoa-Architecture-Hybrid-Apps/">Read on →</a></p>
    

    

    
  </div>


  <footer>
  </footer>

</div>

      </article>
  
    
      <article>
        
<div class="article-container">


  
    <div class="meta-container">
      <header>
        
          <a href="/blog/2015/08/19/Cocoa-Architecture-Switchboard-Pattern/">
        
        
          <h2 class="entry-title">Cocoa Architecture: ARSwitchboard</h2>
        
          <p class="meta-author">
  



  

  
    <div class="meta">
      <span class="byline author vcard"><a href ="/author/orta">Orta Therox<a/></span>
      
      <p class="fn">
        <a href="https://twitter.com/orta">@orta</a>
      </p>
      

    </div>
  

</p>
          </a>
      </header>
    </div>
  

  <div class="content-container">
    
    
        <p>As a part of going through the design patterns we've found in the creation of the Artsy iOS apps, I'd like to introduce the Switchboard pattern. This evolved quite naturally out of <a href="/blog/2015/08/15/Cocoa-Architecture:-Router-Pattern/">ARRouter</a> when applied to generating view controllers instead of API requests.</p>


        <p><a href="/blog/2015/08/19/Cocoa-Architecture-Switchboard-Pattern/">Read on →</a></p>
    

    

    
  </div>


  <footer>
  </footer>

</div>

      </article>
  
    
      <article>
        
<div class="article-container">


  
    <div class="meta-container">
      <header>
        
          <a href="/blog/2015/08/15/Cocoa-Architecture-Router-Pattern/">
        
        
          <h2 class="entry-title">Cocoa Architecture: ARRouter</h2>
        
          <p class="meta-author">
  



  

  
    <div class="meta">
      <span class="byline author vcard"><a href ="/author/orta">Orta Therox<a/></span>
      
      <p class="fn">
        <a href="https://twitter.com/orta">@orta</a>
      </p>
      

    </div>
  

</p>
          </a>
      </header>
    </div>
  

  <div class="content-container">
    
    
        <p>I want to talk about a pattern that we've been using for the last few years on the Artsy Mobile team. This pattern pre-dates me joining Artsy by a few weeks, and was introduced into our codebase by <a href="http://90wpm.com">Ben Jackson</a>, this was the <code>ARRouter</code>'s first method:</p>

<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='objc'><span class='line'>  <span class="o">+</span> <span class="p">(</span><span class="bp">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="nl">newOAuthURLWithUsername</span><span class="p">:(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">username</span> <span class="nl">password</span><span class="p">:(</span><span class="bp">NSString</span> <span class="o">*</span><span class="p">)</span><span class="n">password</span> <span class="p">{</span>
</span><span class='line'>      <span class="bp">NSDictionary</span> <span class="o">*</span><span class="n">params</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSDictionary</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithObjectsAndKeys</span><span class="p">:</span>
</span><span class='line'>                              <span class="n">username</span><span class="p">,</span> <span class="s">@&quot;email&quot;</span><span class="p">,</span>
</span><span class='line'>                              <span class="n">password</span><span class="p">,</span> <span class="s">@&quot;password&quot;</span><span class="p">,</span>
</span><span class='line'>                              <span class="n">ARAuthClientID</span><span class="p">,</span> <span class="s">@&quot;client_id&quot;</span><span class="p">,</span>
</span><span class='line'>                              <span class="n">ARAuthSecret</span><span class="p">,</span> <span class="s">@&quot;client_secret&quot;</span><span class="p">,</span>
</span><span class='line'>                              <span class="s">@&quot;credentials&quot;</span><span class="p">,</span> <span class="s">@&quot;grant_type&quot;</span><span class="p">,</span>
</span><span class='line'>                              <span class="nb">nil</span><span class="p">];</span>
</span><span class='line'>      <span class="bp">NSString</span> <span class="o">*</span><span class="n">url_string</span> <span class="o">=</span> <span class="p">[[</span><span class="bp">NSString</span> <span class="n">alloc</span><span class="p">]</span> <span class="nl">initWithFormat</span><span class="p">:</span><span class="s">@&quot;%@%@&quot;</span><span class="p">,</span> <span class="n">AROAuthURL</span><span class="p">,</span> <span class="p">[</span><span class="n">params</span> <span class="n">queryString</span><span class="p">]];</span>
</span><span class='line'>      <span class="bp">NSURL</span> <span class="o">*</span><span class="n">url</span> <span class="o">=</span> <span class="p">[</span><span class="n">ARRouter</span> <span class="nl">newURLWithPath</span><span class="p">:</span><span class="n">url_string</span><span class="p">];</span>
</span><span class='line'>      <span class="p">[</span><span class="n">url_string</span> <span class="k">release</span><span class="p">];</span>
</span><span class='line'>      <span class="p">[</span><span class="n">params</span> <span class="k">release</span><span class="p">];</span>
</span><span class='line'>      <span class="k">return</span> <span class="n">url</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div>


<p>Yep, that's pre-ARC, pre-Dictionary Literals, memory-managed code. We took this pattern and rolled with it for the next 4 years, this article is about where we've taken it.</p>

<p>Within Eigen, <code>ARRouter</code> is one of our <a href="https://github.com/artsy/eigen/blob/904e8abfc11ce6ea4b6e81f0e02684b755a280c3/Artsy/Networking/ARRouter.m">biggest classes</a>, coming in at almost 1,000 lines of code. Whereas in Energy, it sits at a <a href="https://github.com/artsy/energy/blob/e51529250ede359c781042f222d5836eb9e8a979/Classes/Util/App/ARRouter.m">more reasonable</a> 300 lines. Eidolon does not have an ARRouter, what gives?</p>


        <p><a href="/blog/2015/08/15/Cocoa-Architecture-Router-Pattern/">Read on →</a></p>
    

    

    
  </div>


  <footer>
  </footer>

</div>

      </article>
  
    
      <article>
        
<div class="article-container">


  
    <div class="meta-container">
      <header>
        
          <a href="/blog/2015/08/10/peer-lab/">
        
        
          <h2 class="entry-title">Peer Lab</h2>
        
          <p class="meta-author">
  



  

  
    <div class="meta">
      <span class="byline author vcard"><a href ="/author/ash">Ash Furrow<a/></span>
      
      <p class="fn">
        <a href="https://twitter.com/ashfurrow">@ashfurrow</a>
      </p>
      

    </div>
  

</p>
          </a>
      </header>
    </div>
  

  <div class="content-container">
    
    
        <p>When I was living in Amsterdam, I participated in plenty of <a href="https://appsterdam.rs">Appsterdam</a> events. Things like the weekly Meeten en Drinken. I even helped lead a class in Swift. One of the events I liked the most was called Peer Lab, organized every Saturday morning by <a href="https://twitter.com/samuelgoodwin">Samuel Goodwin</a>.</p>

<p>The idea of Peer Lab is pretty simple, but also somewhat profound: developers gather in a physical space to work on things. If someone has a question, they ask the group. If you can help, you offer assistance. The goal is to foster a collaborative learning environment where everyone feels fulfilled.</p>


        <p><a href="/blog/2015/08/10/peer-lab/">Read on →</a></p>
    

    

    
  </div>


  <footer>
  </footer>

</div>

      </article>
  

  <div class="pagination">
    <a href="/blog/archives">Blog Archives</a>
    <a href="/blog/categories">Categories</a>

    
      <a href="/blog/9/" class="previous">Previous</a>
    
    <span class="page_number ">Page: 10 of 19</span>

    
      <a href="/blog/11/" class="next">Older</a>
    
  </div>
</div>


    </div>
  </div>
  <footer id="main_footer"> <div class="footer-navigation">
  <ul>
    <li><a href="https://developers.artsy.net/">API</a></li>
    <li><a href="https://www.artsy.net/jobs">Careers</a></li>
    <li><a href="http://twitter.com/artsyopensource">@artsyopensource</a></li>
    <li><a href="http://www.artsy.net/">Artsy.net</a></li>
  </ul>
</div>



<script type="text/javascript">
      var disqus_shortname = 'artsy';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'https://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>


</footer>
  <script type="text/javascript">
  $(function() {
    // TODO: Move this whole file to a javascript file that is included in the footer

    // Main sticky header
    if ($(window).width() >= 700) {
      var sticky = new Waypoint.Sticky({
        element: $("#banner"),
        offset: -100
      });
    }

    // Toggle hamburger menu
    $('.header-hamburger').click(function() {
      $('#banner, .cmn-toggle-switch').toggleClass('active');
      if (location.pathname == '/open-source') {
        $('.header-search span').hide();
        $('#page-sidebar').toggle();
      }
    });

    // Toggle search focus on mobile
    $('input.search').focus(function() {
      $('#header').addClass('search-focused');
    }).blur(function() {
      $('#header').removeClass('search-focused');
    });
  });
</script>

</body>
</html>
